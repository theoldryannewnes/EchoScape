import{d as A,f as P,h as B,b as N,w as h,i as k}from"./index-BoJZFpIb.js";import{f as F,g as H,a as $}from"./index8-BVzfGxSx.js";import{K as W,a as U}from"./keyboard2-DJlTgB_p.js";/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const D=new WeakMap,I=(e,t,s,o=0,r=!1)=>{D.has(e)!==s&&(s?q(e,t,o,r):G(e,t))},Y=e=>e===e.getRootNode().activeElement,q=(e,t,s,o=!1)=>{const r=t.parentNode,n=t.cloneNode(!1);n.classList.add("cloned-input"),n.tabIndex=-1,o&&(n.disabled=!0);const a=e.ownerDocument.dir==="rtl";if(a){const u=r.offsetWidth-t.offsetLeft-t.offsetWidth;n.style.insetInlineStart="".concat(u,"px")}else n.style.insetInlineStart="".concat(t.offsetLeft,"px");r.appendChild(n),D.set(e,n);const f=a?9999:-9999;e.style.pointerEvents="none",t.style.transform="translate3d(".concat(f,"px,").concat(s,"px,0) scale(0)")},G=(e,t)=>{const s=D.get(e);s&&(D.delete(e),s.remove()),e.style.pointerEvents="",t.style.transform=""},O=50,z=(e,t,s)=>{if(!s||!t)return()=>{};const o=a=>{Y(t)&&I(e,t,a)},r=()=>I(e,t,!1),n=()=>o(!0),c=()=>o(!1);return P(s,"ionScrollStart",n),P(s,"ionScrollEnd",c),t.addEventListener("blur",r),()=>{B(s,"ionScrollStart",n),B(s,"ionScrollEnd",c),t.removeEventListener("blur",r)}},T="input, textarea, [no-blur], [contenteditable]",j=()=>{let e=!0,t=!1;const s=document,o=()=>{t=!0},r=()=>{e=!0},n=c=>{if(t){t=!1;return}const a=s.activeElement;if(!a||a.matches(T))return;const f=c.target;f!==a&&(f.matches(T)||f.closest(T)||(e=!1,setTimeout(()=>{e||a.blur()},50)))};return P(s,"ionScrollStart",o),s.addEventListener("focusin",r,!0),s.addEventListener("touchend",n,!1),()=>{B(s,"ionScrollStart",o,!0),s.removeEventListener("focusin",r,!0),s.removeEventListener("touchend",n,!1)}},J=.3,Q=(e,t,s,o)=>{var r;const n=(r=e.closest("ion-item,[ion-item]"))!==null&&r!==void 0?r:e;return V(n.getBoundingClientRect(),t.getBoundingClientRect(),s,o)},V=(e,t,s,o)=>{const r=e.top,n=e.bottom,c=t.top,a=Math.min(t.bottom,o-s),f=c+15,u=a-O-n,d=f-r,S=Math.round(u<0?-u:d>0?-d:0),v=Math.min(S,r-c),i=Math.abs(v)/J,m=Math.min(400,Math.max(150,i));return{scrollAmount:v,scrollDuration:m,scrollPadding:s,inputSafeY:-(r-f)+4}},R="$ionPaddingTimer",M=(e,t,s)=>{const o=e[R];o&&clearTimeout(o),t>0?e.style.setProperty("--keyboard-offset","".concat(t,"px")):e[R]=setTimeout(()=>{e.style.setProperty("--keyboard-offset","0px"),s&&s()},120)},_=(e,t,s)=>{const o=()=>{t&&M(t,0,s)};e.addEventListener("focusout",o,{once:!0})};let g=0;const K="data-ionic-skip-scroll-assist",X=(e,t,s,o,r,n,c,a=!1)=>{const f=n&&(c===void 0||c.mode===U.None);let l=!1;const u=h!==void 0?h.innerHeight:0,d=y=>{if(l===!1){l=!0;return}p(e,t,s,o,y.detail.keyboardHeight,f,a,u,!1)},S=()=>{l=!1,h===null||h===void 0||h.removeEventListener("ionKeyboardDidShow",d),e.removeEventListener("focusout",S)},v=async()=>{if(t.hasAttribute(K)){t.removeAttribute(K);return}p(e,t,s,o,r,f,a,u),h===null||h===void 0||h.addEventListener("ionKeyboardDidShow",d),e.addEventListener("focusout",S)};return e.addEventListener("focusin",v),()=>{e.removeEventListener("focusin",v),h===null||h===void 0||h.removeEventListener("ionKeyboardDidShow",d),e.removeEventListener("focusout",S)}},C=e=>{var t;if(document.activeElement===e)return;const s=e.getAttribute("id"),o=e.closest('label[for="'.concat(s,'"]')),r=(t=document.activeElement)===null||t===void 0?void 0:t.closest('label[for="'.concat(s,'"]'));o!==null&&o===r||(e.setAttribute(K,"true"),e.focus())},p=async(e,t,s,o,r,n,c=!1,a=0,f=!0)=>{if(!s&&!o)return;const l=Q(e,s||o,r,a);if(s&&Math.abs(l.scrollAmount)<4){C(t),n&&s!==null&&(M(s,g),_(t,s,()=>g=0));return}if(I(e,t,!0,l.inputSafeY,c),C(t),k(()=>e.click()),n&&s&&(g=l.scrollPadding,M(s,g)),typeof window<"u"){let u;const d=async()=>{u!==void 0&&clearTimeout(u),window.removeEventListener("ionKeyboardDidShow",S),window.removeEventListener("ionKeyboardDidShow",d),s&&await $(s,0,l.scrollAmount,l.scrollDuration),I(e,t,!1,l.inputSafeY),document.activeElement===t&&C(t),n&&_(t,s,()=>g=0)},S=()=>{window.removeEventListener("ionKeyboardDidShow",S),window.addEventListener("ionKeyboardDidShow",d)};if(s){const v=await H(s),y=v.scrollHeight-v.clientHeight;if(f&&l.scrollAmount>y-v.scrollTop){t.type==="password"?(l.scrollAmount+=O,window.addEventListener("ionKeyboardDidShow",S)):window.addEventListener("ionKeyboardDidShow",d),u=setTimeout(d,1e3);return}}d()}},Z=!0,oe=async(e,t)=>{if(A===void 0)return;const s=t==="ios",o=t==="android",r=e.getNumber("keyboardHeight",290),n=e.getBoolean("scrollAssist",!0),c=e.getBoolean("hideCaretOnScroll",s),a=e.getBoolean("inputBlurring",!1),f=e.getBoolean("scrollPadding",!0),l=Array.from(A.querySelectorAll("ion-input, ion-textarea")),u=new WeakMap,d=new WeakMap,S=await W.getResizeMode(),v=async i=>{await new Promise(w=>N(i,w));const m=i.shadowRoot||i,b=m.querySelector("input")||m.querySelector("textarea"),L=F(i),x=L?null:i.closest("ion-footer");if(!b)return;if(L&&c&&!u.has(i)){const w=z(i,b,L);u.set(i,w)}if(!(b.type==="date"||b.type==="datetime-local")&&(L||x)&&n&&!d.has(i)){const w=X(i,b,L,x,r,f,S,o);d.set(i,w)}},y=i=>{if(c){const m=u.get(i);m&&m(),u.delete(i)}if(n){const m=d.get(i);m&&m(),d.delete(i)}};a&&Z&&j();for(const i of l)v(i);A.addEventListener("ionInputDidLoad",i=>{v(i.detail)}),A.addEventListener("ionInputDidUnload",i=>{y(i.detail)})};export{oe as startInputShims};
